<<<<<<< HEAD
=======
const { env } = require('process')

>>>>>>> Refactor some code in `@netlify/config`
const NetlifyAPI = require('netlify')

const { removeFalsy } = require('../utils/remove_falsy')

// Retrieve Netlify API client, if an access token was passed
const getApiClient = function({ token = env.NETLIFY_AUTH_TOKEN, testOpts: { scheme, host } = {} }) {
  if (!token) {
    return
  }

  // TODO: find less intrusive way to mock HTTP requests
<<<<<<< HEAD
  const parameters = removeFalsy({ scheme, host })
=======
  const parameters = removeFalsy({ scheme: env.TEST_SCHEME, host: env.TEST_HOST })
>>>>>>> Refactor some code in `@netlify/config`
  const api = new NetlifyAPI(token, parameters)
  return api
}

module.exports = { getApiClient }
